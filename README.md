# pfSense SSH CrowdSec Parser (kaijo/sshd-logs-pfsense)

A pfSense‑optimized CrowdSec SSH parser providing full coverage for FreeBSD/pfSense SSH logs (sshd & sshd‑session).

This parser is designed specifically for pfSense 24.x and 25.x, which use FreeBSD’s OpenSSH logging format.  
It provides complete parsing for all SSH‑related events generated by pfSense, including:

- Successful logins  
- PAM authentication errors  
- Permission denied events  
- Pre‑authentication disconnects  
- Timeouts before authentication  
- Normal session closures  
- Disconnects with reason  
- sshguard events (ignored)

## Features

- Full coverage of all pfSense/FreeBSD SSH log formats  
- Works with both `sshd` and `sshd-session`  
- IPv4 + IPv6 support  
- Clean metadata output for CrowdSec scenarios  
- Compatible with CrowdSec 1.5+  
- Whitelist‑friendly (private IPs are ignored automatically)

## Installation

Clone or download this repository, then install the parser manually:

cscli parsers install ./parsers/s01-parse/kaijo/sshd-logs-pfsense.yaml

Or place the file under:  
/etc/crowdsec/parsers/s01-parse/kaijo/

## Example Logs from /var/log/auth.log

Accepted keyboard-interactive/pam for admin from 192.168.1.10 port 54321 ssh2
error: PAM: Authentication error for root from 192.168.1.10
process_output: ssh_packet_write_poll: Connection from user admin 192.168.1.10 port 54321: Permission denied
Timeout before authentication for connection from 192.168.1.10 to 192.168.1.1, pid = 12345
Connection closed by authenticating user root 192.168.1.10 port 54321 [preauth]

## Future Extensions

This repository will later include:

- pfSense OpenVPN parser  
- pfSense SSH brute‑force scenario  
- pfSense security collection (`kaijo/pfsense-ssh`)  

Stay tuned.

## Author

**kaijo**  
GitHub: https://github.com/kaijo-hub
