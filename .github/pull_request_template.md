# CrowdSec Hub – Pull Request: pfSense SSH Parser (kaijo/sshd-logs-pfsense)

##   Overview

This PR adds a pfSense‑optimized SSH parser to the CrowdSec Hub:

**Parser name:** `kaijo/sshd-logs-pfsense`  
**Collection:** `kaijo/pfsense-ssh`  
**Author:** kaijo  
**Supported systems:** pfSense 24.x / 25.x (FreeBSD-based)

The parser provides complete coverage for all SSH‑related log formats generated by pfSense (`sshd` and `sshd-session`).

---

##   What this parser covers

The parser handles all SSH log events produced by pfSense, including:

- Successful authentication  
- PAM authentication errors  
- Permission denied events  
- Disconnects with reason  
- Normal session closures  
- Timeouts before authentication  
- sshguard events (ignored)

IPv4 and IPv6 are fully supported.

---

##    Files included in this PR

### Parser

parsers/s01-parse/kaijo/sshd-logs-pfsense.yaml

### Collection

collections/kaijo-pfsense-ssh.yaml

### Metadata

- config.yaml
- LICENCE
- README.md

##    Testing performed

The parser was tested against real pfSense logs from pfSense 24.x and 25.x:

- Verified correct extraction of:
  - `user`
  - `src_ip`
  - `dst_ip`
  - `src_port`
  - `reason`
  - `log_type`
- Confirmed compatibility with CrowdSec 1.5+
- Confirmed correct stage execution (`s01-parse`)
- Confirmed no YAML schema errors
- Confirmed no dead patterns
- Confirmed correct handling of IPv4 + IPv6
- Confirmed sshguard events are ignored

---

##   Example logs used for validation

Accepted keyboard-interactive/pam for admin from 2a02:xxxx port 59208 ssh2
error: PAM: Authentication error for root from 192.168.1.10
process_output: ssh_packet_write_poll: Connection from user admin 192.168.1.10 port 54321: Permission denied
Timeout before authentication for connection from 192.168.1.10 to 192.168.1.1, pid = 12345
Connection closed by 192.168.1.10 port 54321
Received disconnect from 2a02:xxxx port 12345: Bye Bye

---

##   Future extensions (planned)

- pfSense OpenVPN parser  
- pfSense firewall parser  
- pfSense SSH brute‑force scenario  
- Full pfSense security bundle (`kaijo/pfsense-security`)  

---

##   Ready for review

This PR is complete and ready for review by the CrowdSec team.

  
